#!/usr/bin/env sh
. "$(dirname "$0")/_/husky.sh"

# Prevent direct pushes to main branch
protected_branch='main'
current_branch=$(git symbolic-ref HEAD | sed -e 's,.*/\(.*\),\1,')

if [ "$protected_branch" = "$current_branch" ]; then
  echo "âŒ Direct pushes to '$protected_branch' branch are not allowed!"
  echo "ğŸ“ Please create a feature branch and use a Pull Request instead."
  echo ""
  echo "   Example:"
  echo "   git checkout -b feature/your-feature-name"
  echo "   git push origin feature/your-feature-name"
  echo ""
  exit 1
fi

echo "ğŸ”¨ Running build before push..."

npm run build

if [ $? -ne 0 ]; then
  echo "âŒ Build failed! Push aborted."
  exit 1
fi

echo "âœ… Build successful! Proceeding with push..."
